# Falco Helm Chart Values
# Version: 0.43.0 (February 2026)
# Note: Falco 0.43.0 deprecates legacy eBPF probe, gVisor engine, and gRPC.
# Use modern_ebpf for production deployments.

# Modern eBPF driver - recommended for production
driver:
  kind: modern_ebpf

# Falco configuration
falco:
  grpc:
    enabled: true
    bind_address: "unix:///run/falco/falco.sock"
    threadiness: 0
  grpc_output:
    enabled: true

  # JSON output for easy parsing
  json_output: true
  json_include_output_property: true
  json_include_tags_property: true

  # Log level
  log_level: info

  # Rule files to load
  rules_file:
    - /etc/falco/falco_rules.yaml
    - /etc/falco/falco_rules.local.yaml
    - /etc/falco/rules.d

  # Syscall event drops - alert if Falco can't keep up
  syscall_event_drops:
    threshold: 0.1
    actions:
      - log
      - alert

# Load custom rules
customRules:
  financial-services.yaml: |
    # Custom rules for financial services environments
    # See custom-rules/financial-services.yaml for full content

# Tolerations to run on all nodes
tolerations:
  - effect: NoSchedule
    operator: Exists

# Resource requests/limits
resources:
  requests:
    cpu: 100m
    memory: 512Mi
  limits:
    cpu: 1000m
    memory: 1024Mi

# Prometheus metrics
serviceMonitor:
  enabled: true
